---
export interface Props {
  variant?: 'light' | 'dark';
}

const { variant = 'light' } = Astro.props;

const isDark = variant === 'dark';
const bgClass = isDark ? 'bg-transparent' : 'bg-bg-primary border-b border-border';
const logoClass = isDark ? 'text-white' : 'text-gradient-primary';
const linkClass = isDark
  ? 'text-white/80 hover:text-white'
  : 'text-text-secondary hover:text-text-primary';
const mobileMenuClass = isDark
  ? 'border-white/20'
  : 'border-border';
const dropdownBgClass = isDark
  ? 'bg-dark-800 border-white/10'
  : 'bg-white border-border shadow-lg';
const dropdownLinkClass = isDark
  ? 'text-white/80 hover:text-white hover:bg-white/10'
  : 'text-text-secondary hover:text-text-primary hover:bg-bg-secondary';

// Resources dropdown items
const resourceLinks = [
  { name: 'Brand Mentions by AI', href: '/rankings/', description: 'See how AI ranks brands' },
  { name: 'AI Search Engines', href: '/ai-search-engine/', description: 'Guides to AI search' },
  { name: 'AI Chatbots', href: '/ai-chat-bot/', description: 'Guides to AI chatbots' },
  { name: 'AI Crawler Bots', href: '/ai-crawler-bot/', description: 'Guides to AI crawlers' },
];
---

<nav class={`${bgClass} relative z-50`}>
  <div class="container mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <a href="/" class={`${logoClass} font-heading flex flex-col leading-none`}>
        <span class="text-2xl font-bold tracking-tight">AICW</span>
        <span class="text-[10px] tracking-widest uppercase opacity-70">AI Chat Watch</span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex gap-6 items-center">
        <a href="/#features" class={`${linkClass} transition-colors`}>
          Features
        </a>
        <a href="/blog/" class={`${linkClass} transition-colors`}>
          Blog
        </a>

        <!-- Resources Dropdown -->
        <div class="relative group">
          <button class={`${linkClass} transition-colors flex items-center gap-1`}>
            Resources
            <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>

          <!-- Dropdown Menu -->
          <div class={`absolute top-full left-0 mt-2 w-64 rounded-lg border ${dropdownBgClass} opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200`}>
            <div class="py-2">
              {resourceLinks.map((link) => (
                <a
                  href={link.href}
                  class={`block px-4 py-3 ${dropdownLinkClass} transition-colors`}
                >
                  <div class="font-medium">{link.name}</div>
                  <div class={`text-xs ${isDark ? 'text-white/50' : 'text-text-light'}`}>{link.description}</div>
                </a>
              ))}
            </div>
          </div>
        </div>

        <!-- CTA and Login -->
        <a href="https://app.aicw.io" class="px-4 py-2 gradient-primary rounded-lg text-white font-medium hover:shadow-lg transition-all">
          Track AI Visibility
        </a>
        <a href="https://app.aicw.io" class={`${linkClass} transition-colors`}>
          Login
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button id="mobile-menu-btn" class={`md:hidden p-2 ${linkClass}`} aria-label="Toggle menu">
        <svg id="menu-icon-open" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
        <svg id="menu-icon-close" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class={`hidden md:hidden mt-4 pb-4 border-t ${mobileMenuClass} pt-4`}>
      <div class="flex flex-col gap-4">
        <a href="/#features" class={`${linkClass} transition-colors`}>
          Features
        </a>
        <a href="/blog/" class={`${linkClass} transition-colors`}>
          Blog
        </a>

        <!-- Mobile Resources Section -->
        <div class="pt-2">
          <div class={`text-sm font-semibold mb-2 ${isDark ? 'text-white/50' : 'text-text-light'}`}>
            Resources
          </div>
          <div class="flex flex-col gap-2 pl-4">
            {resourceLinks.map((link) => (
              <a href={link.href} class={`${linkClass} transition-colors`}>
                {link.name}
              </a>
            ))}
          </div>
        </div>

        <!-- Mobile CTAs -->
        <div class="flex flex-col gap-3 pt-4 border-t border-current/10">
          <a href="https://app.aicw.io" class="px-4 py-2 gradient-primary rounded-lg text-white font-medium hover:shadow-lg transition-all text-center">
            Track AI Visibility
          </a>
          <a href="https://app.aicw.io" class={`${linkClass} transition-colors text-center`}>
            Login
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIconOpen = document.getElementById('menu-icon-open');
  const menuIconClose = document.getElementById('menu-icon-close');

  mobileMenuBtn?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
    menuIconOpen?.classList.toggle('hidden');
    menuIconClose?.classList.toggle('hidden');
  });
</script>
