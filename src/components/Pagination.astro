---
/**
 * Pagination - Navigation for paginated blog listing
 * Pattern inspired by ayodesk.com implementation
 */

interface Props {
  currentPage: number;
  totalPages: number;
  basePath?: string;
}

const { currentPage, totalPages, basePath = '/blog' } = Astro.props;

// Calculate page range (show up to 5 pages at a time)
let startPage = Math.max(1, currentPage - 2);
let endPage = Math.min(totalPages, startPage + 4);

// Adjust start if we're near the end
if (endPage - startPage < 4) {
  startPage = Math.max(1, endPage - 4);
}

const pages = Array.from(
  { length: endPage - startPage + 1 },
  (_, i) => startPage + i
);

// Generate URL for a page number
function getPageUrl(page: number): string {
  if (page === 1) {
    return `${basePath}/`;
  }
  return `${basePath}/page/${page}/`;
}
---

{totalPages > 1 && (
  <nav class="mt-12 flex flex-wrap justify-center gap-2" aria-label="Blog pagination">
    {/* Previous button */}
    {currentPage > 1 && (
      <a
        href={getPageUrl(currentPage - 1)}
        class="flex items-center justify-center px-3 py-2 bg-bg-primary border border-border text-text-primary rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-all"
        aria-label="Previous page"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </a>
    )}

    {/* First page + ellipsis if needed */}
    {startPage > 1 && (
      <>
        <a
          href={getPageUrl(1)}
          class="flex items-center justify-center px-4 py-2 bg-bg-primary border border-border text-text-primary rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-all"
        >
          1
        </a>
        {startPage > 2 && (
          <span class="flex items-center justify-center px-2 py-2 text-text-light">
            ...
          </span>
        )}
      </>
    )}

    {/* Page numbers */}
    {pages.map((page) => (
      page === currentPage ? (
        <span
          class="flex items-center justify-center px-4 py-2 bg-primary-600 text-white rounded-lg font-medium"
          aria-current="page"
        >
          {page}
        </span>
      ) : (
        <a
          href={getPageUrl(page)}
          class="flex items-center justify-center px-4 py-2 bg-bg-primary border border-border text-text-primary rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-all"
        >
          {page}
        </a>
      )
    ))}

    {/* Last page + ellipsis if needed */}
    {endPage < totalPages && (
      <>
        {endPage < totalPages - 1 && (
          <span class="flex items-center justify-center px-2 py-2 text-text-light">
            ...
          </span>
        )}
        <a
          href={getPageUrl(totalPages)}
          class="flex items-center justify-center px-4 py-2 bg-bg-primary border border-border text-text-primary rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-all"
        >
          {totalPages}
        </a>
      </>
    )}

    {/* Next button */}
    {currentPage < totalPages && (
      <a
        href={getPageUrl(currentPage + 1)}
        class="flex items-center justify-center px-3 py-2 bg-bg-primary border border-border text-text-primary rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-all"
        aria-label="Next page"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
    )}
  </nav>
)}

{/* Page info text */}
{totalPages > 1 && (
  <p class="mt-4 text-center text-sm text-text-light">
    Page {currentPage} of {totalPages}
  </p>
)}
